{
  "PromptInjection": " The following is a detailed schema and event hierarchy for a Plunger Lift Optimization system. Use this structure to generate SQL queries based on user input. Table names, fields, and relationships are included below.\n\nSchema Overview:\n\n1. EVENTS (Main relational anchor)\n   - Links all event types by storing their primary keys.\n   - Fields: cycle_id, basic_pressure_event, cycle_duration_event, gas_volume_produced_event, plunger_arrival_velocity_event, unexpected_low_casing_pressure, plunger_arrival_status_event, plunger_unsafe_velocity_event, unexpected_low_flow, unexpected_low_cycle_duration, unexpected_high_cycle_duration\n\n2. CYCLE_DURATION_EVENTS\n   - Fields: start_time, end_time, total_duration, flow_duration, shutin_duration\n   - Represents CycleDurationEvent (core metric)\n\n3. BASIC_PRESSURE_EVENTS\n   - Fields: delta_pt, delta_cp, delta_pl, ph\n   - Represents BasicPressureEvent (core metric)\n\n4. GAS_VOLUME_PRODUCED_EVENTS\n   - Fields: gas_volume, cycle_duration_event\n   - Represents GasVolumeProduced event (core metric)\n\n5. PLUNGER_ARRIVAL_VELOCITY_EVENTS\n   - Fields: arrival_speed\n   - Represents PlungerArrivalVelocityEvent\n\n6. PLUNGER_UNSAFE_VELOCITY_EVENTS\n   - Fields: velocity_event (FK to PLUNGER_ARRIVAL_VELOCITY_EVENTS)\n   - Triggered when arrival_speed > safety threshold\n\n7. PLUNGER_ARRIVAL_STATUS_EVENTS\n   - Fields: non_arrival, unexpected_casing_pressure, unexpected_low_casing_pressure (FK)\n   - Represents PlungerArrivalStatus\n\n8. UNEXPECTED_LOW_CASING_PRESSURE_EVENTS\n   - Field: basic_pressure_event (FK to BASIC_PRESSURE_EVENTS)\n   - Triggered when delta_cp is too low\n\n9. UNEXPECTED_LOW_FLOW_EVENTS\n   - Field: gas_volume_produced_event (FK to GAS_VOLUME_PRODUCED_EVENTS)\n   - Triggered when gas_volume is low\n\n10. UNEXPECTED_LOW_CYCLE_DURATION_EVENTS\n    - Field: cycle_duration_event (FK)\n    - Triggered when total/flow/shutin_duration is too short\n\n11. UNEXPECTED_HIGH_CYCLE_DURATION_EVENTS\n    - Field: cycle_duration_event (FK)\n    - Triggered when total/flow/shutin_duration is too long\n\n\nHierarchical Relationships (for reasoning):\n\n- CycleDataEvent \u2192\n  - BasicPressureEvent (BASIC_PRESSURE_EVENTS)\n  - CycleDurationEvent (CYCLE_DURATION_EVENTS)\n  - GasVolumeProduced (GAS_VOLUME_PRODUCED_EVENTS)\n  - PlungerArrivalVelocity (PLUNGER_ARRIVAL_VELOCITY_EVENTS)\n\n- CycleAnomalyEvent \u2192\n  - PlungerUnsafeVelocity (PLUNGER_UNSAFE_VELOCITY_EVENTS)\n  - PlungerArrivalStatus (PLUNGER_ARRIVAL_STATUS_EVENTS)\n  - UnexpectedLowCasingPressure (UNEXPECTED_LOW_CASING_PRESSURE_EVENTS)\n  - UnexpectedLowFlow (UNEXPECTED_LOW_FLOW_EVENTS)\n  - UnexpectedLowCycleDuration (UNEXPECTED_LOW_CYCLE_DURATION_EVENTS)\n  - UnexpectedHighCycleDuration (UNEXPECTED_HIGH_CYCLE_DURATION_EVENTS)\n\n- PlungerArrivalStatus \u2192 UnexpectedLowCasingPressure\n- PlungerUnsafeVelocity \u2192 PlungerArrivalVelocity\n- UnexpectedLowCasingPressure \u2192 BasicPressureEvent\n- UnexpectedLowFlow \u2192 GasVolumeProduced\n- UnexpectedLowCycleDuration \u2192 CycleDurationEvent\n- UnexpectedHighCycleDuration \u2192 CycleDurationEvent\n- GasVolumeProduced \u2192 CycleDurationEvent\n\nUse this knowledge to resolve user prompts like \"show average arrival speed in last 2 days\" even when table names are not explicitly mentioned.",
  "PromptInjection1": " Here is the hierarchical structure of the events, showing the parent-child relationships based on the provided data.\nPlunger Lift Event Hierarchy\n\n    CycleDataEvent (Parent)\n\n        BasicPressureEvent (Child)\n\n        CycleDurationEvent (Child)\n\n        GasVolumeProduced (Child)\n\n        PlungerArrivalVelocity (Child, referred to as velocityEvent)\n\n    CycleAnomalyEvent (Parent)\n\n        PlungerUnsafeVelocity (Child)\n\n        PlungerArrivalStatus (Child, specifically the plungerNonArrival attribute)\n\n        UnexpectedLowCasingPressure (Child)\n\n        UnexpectedLowFlow (Child)\n\n        UnexpectedLowCycleDuration (Child)\n\n        UnexpectedHighCycleDuration (Child)\n\n    PlungerArrivalStatus (Parent)\n\n        UnexpectedLowCasingPressure (Child, as a diagnostic sub-condition)\n\n    PlungerUnsafeVelocity (Parent)\n\n        PlungerArrivalVelocity (Child, as it uses the arrival_speed from this event)\n\n    UnexpectedLowCasingPressure (Parent)\n\n        BasicPressureEvent (Child, as it uses delta_Cp from this event)\n\n    UnexpectedLowFlow (Parent)\n\n        GasVolumeProduced (Child, as it uses the gas_volume from this event)\n\n    UnexpectedLowCycleDuration (Parent)\n\n        CycleDurationEvent (Child, as it uses the duration variables from this event)\n\n    UnexpectedHighCycleDuration (Parent)\n\n        CycleDurationEvent (Child, as it uses the duration variables from this event)\n\n    GasVolumeProduced (Parent)\n\n        CycleDurationEvent (Child, as it uses flow_duration from this event)",
  "event_details": "\n\nEvent Schema Definition\n\nBelow are the detailed definitions for each event type.\n\n1. High-Level Composite Events\n\nThese events aggregate data from multiple sub-events to provide a holistic view of the cycle.\n\nEvent Name: CycleDataEvent\n\nDescription: A comprehensive, top-level event that encapsulates the complete operational snapshot of one full plunger lift cycle. It serves as a container for all granular data and sub-events, enabling a unified analysis of the cycle's dynamics and efficiency.\n\nEvent Type: Composite Container\n\nConstituent Events:\n\nBasicPressureEvent\n\nCycleDurationEvent\n\nGasVolumeProduced\n\nPlungerArrivalVelocityEvent\n\nEvent Name: CycleAnomalyEvent\n\nDescription: A high-level alert event triggered when any critical failure, inefficiency, or safety violation occurs during a cycle. It acts as a wrapper, signaling that a cycle has deviated from expected operational behavior and requires review or intervention.\n\nEvent Type: Composite Anomaly\n\nConstituent Events (Triggers):\n\nPlungerNonArrival\n\nPlungerUnsafeVelocity\n\nUnexpectedLowCasingPressure\n\nUnexpectedLowFlow\n\nUnexpectedLowCycleDuration\n\nUnexpectedHighCycleDuration\n\n2. Core Operational Metric Events\n\nThese events capture the fundamental performance metrics of the cycle.\n\nEvent Name: BasicPressureEvent\n\nDescription: Captures the key pressure changes that drive the plunger lift cycle. It is essential for evaluating lift readiness, pressure buildup, and the overall hydraulic behavior of the well.\n\nEvent Type: Core Metric\n\nVariables:\n\nVariable: delta_Pt\n\nCalculation: Pt_final - Pt_init\n\nDescription: The net change in tubing pressure during the cycle.\n\nUnits: psi\n\nVariable: delta_Cp\n\nCalculation: Cp_final - Cp_init\n\nDescription: The net change in casing pressure, which provides the lifting energy.\n\nUnits: psi\n\nVariable: delta_Pl\n\nCalculation: Pl_final - Pl_init\n\nDescription: The net change in sales line pressure.\n\nUnits: psi\n\nVariable: ph\n\nCalculation: 0.433 * SG * hl\n\nDescription: The hydrostatic pressure exerted by the liquid column (hl) in the tubing, based on its specific gravity (SG).\n\nUnits: psi\n\nEvent Name: CycleDurationEvent\n\nDescription: Defines the key time durations of a complete plunger cycle. These segments are crucial for assessing shut-in strategy, lift frequency, and operational efficiency.\n\nEvent Type: Core Metric\n\nVariables:\n\nVariable: total_cycle_duration\n\nCalculation: end_time - start_time\n\nDescription: The total duration of one complete cycle from start to finish.\n\nUnits: seconds\n\nVariable: flow_duration\n\nCalculation: Time when flow rate > 0 (calculated as timestamp of last non-zero flow minus timestamp of first non-zero flow).\n\nDescription: The total time the well was open and producing gas.\n\nUnits: seconds\n\nVariable: shutin_duration\n\nCalculation: Time when flow rate = 0 (calculated as timestamp of last zero flow minus timestamp of first zero flow).\n\nDescription: The total time the well was closed to build pressure.\n\nUnits: seconds\n\nEvent Name: GasVolumeProduced\n\nDescription: Calculates the total gas volume produced during a single cycle. This is a primary indicator of the cycle's productivity.\n\nEvent Type: Core Metric\n\nVariables:\n\nVariable: gas_volume\n\nCalculation: flow_rate * flow_duration\n\nDescription: The total volume of gas extracted during the cycle's flow period.\n\nUnits: cubic meter\n\n3. Plunger Status and Safety Events\n\nThese events track the plunger's physical behavior and related safety conditions.\n\nEvent Name: PlungerArrivalVelocityEvent\n\nDescription: Measures the velocity at which the plunger arrives at the wellhead. It is a critical metric for both performance and safety, reflecting the dynamic energy of the lift.\n\nEvent Type: Status & Safety Metric\n\nVariables:\n\nVariable: arrival_speed\n\nDescription: The measured velocity of the plunger upon arrival at the surface.\n\nUnits: m/s\n\nEvent Name: PlungerArrivalStatus\n\nDescription: Determines whether the plunger successfully arrived at the surface and provides diagnostic context for failures.\n\nEvent Type: Status\n\nVariables:\n\nVariable: non_arrival\n\nDescription: A boolean flag where true indicates the plunger did not make it to the surface, and false indicates a successful arrival.\n\nUnits: boolean\n\nVariable: UnexpectedLowCasingPressure\n\nDescription: A diagnostic boolean flag indicating if a non-arrival was accompanied by insufficient casing pressure.\n\nUnits: boolean\n\nEvent Name: PlungerUnsafeVelocity\n\nDescription: A safety event triggered when the plunger's arrival velocity exceeds a predefined safety threshold, indicating potentially damaging impact forces or aggressive flow conditions.\n\nEvent Type: Safety Anomaly\n\nTrigger Condition: arrival_speed > predefined_safety_threshold\n\nSource Variable: PlungerArrivalVelocityEvent.arrival_speed\n\n4. Specific Anomaly Events\n\nThese events are triggered when specific operational metrics deviate from their expected thresholds.\n\nEvent Name: UnexpectedLowCasingPressure\n\nDescription: Identifies abnormally low pressure buildup in the casing, which can result in insufficient force to lift the plunger. This points to issues like gas depletion, leaks, or valve malfunctions.\n\nEvent Type: Performance Anomaly\n\nTrigger Condition: BasicPressureEvent.delta_Cp is significantly lower than a predefined system threshold.\n\nEvent Name: UnexpectedLowFlow\n\nDescription: Raised when the gas volume produced during a cycle is significantly lower than expected. It highlights underperformance, possible early plunger fallback, or poor liquid unloading.\n\nEvent Type: Performance Anomaly\n\nTrigger Condition: GasVolumeProduced.gas_volume is below a pre-calculated benchmark.\n\nEvent Name: UnexpectedLowCycleDuration\n\nDescription: Flags abnormally short cycles, suggesting issues like premature venting, shallow slug formation, or mistimed plunger launches. This helps identify inefficient runtimes.\n\nEvent Type: Performance Anomaly\n\nTrigger Condition: Durations from CycleDurationEvent (total, flow, or shut-in) fall below defined lower thresholds.\n\nEvent Name: UnexpectedHighCycleDuration\n\nDescription: Highlights cycles that exceed acceptable time limits. This can indicate poor liquid unloading, sluggish arrival, or excessive shut-in, signaling a need to rebalance the cycle strategy.\n\nEvent Type: Performance Anomaly\n\nTrigger Condition: Durations from CycleDurationEvent (total, flow, or shut-in) are greater than defined upper thresholds."
}